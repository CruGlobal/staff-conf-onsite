context.instance_exec do
  columns do
    column do
      attributes_table do
        row :code
        row :name
        row(:parent) do |m|
          link_to m.parent, m.parent if m.parent.present?
        end
        row :created_at
        row :updated_at
      end

      active_admin_comments
    end

    column do
      if ministry.ancestors.any? || ministry.children.any?
        panel 'Hierarchy', class: 'hierarchy' do
          div class: 'ministry__hierarchy' do
            if ministry.ancestors.any?
              ul class: 'ministry__hierarchy__ancestors' do
                ministry.ancestors.each do |m|
                  li(class: 'ministry__hierarchy__ancestor') { link_to m, m }
                end
              end
            end

            div(class: 'ministry__hierarchy__this') { ministry }

            if ministry.children.any?
              ul class: 'ministry__hierarchy__children' do
                ministry.children.each do |child|
                  li class: 'ministry__hierarchy__child' do
                    link_to child, child
                  end
                end
              end
            end
          end
        end
      end

      num_members = ministry.people.size

      panel "Members (#{num_members})", class: 'members' do
        if num_members.positive?
          ul do
            ministry.people.each do |p|
              li { link_to(p.full_name, p) }
            end
          end
        else
          strong('None')
        end
      end
    end
  end
end
